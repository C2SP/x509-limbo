{
  "$defs": {
    "Feature": {
      "description": "Feature tags for testcases.",
      "enum": [
        "has-cert-policies",
        "no-cert-policies",
        "pedantic-public-suffix-wildcard",
        "name-constraint-dn",
        "pedantic-webpki",
        "pedantic-webpki-eku",
        "pedantic-serial-number"
      ],
      "title": "Feature",
      "type": "string"
    },
    "KeyUsage": {
      "description": "X.509 key usages.\n\nSee: https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3",
      "enum": [
        "digitalSignature",
        "contentCommitment",
        "keyEncipherment",
        "dataEncipherment",
        "keyAgreement",
        "keyCertSign",
        "cRLSign",
        "encipher_only",
        "decipher_only"
      ],
      "title": "KeyUsage",
      "type": "string"
    },
    "KnownEKUs": {
      "description": "Well-known extended key usages, from RFC 5280.\n\nSee: https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12",
      "enum": [
        "anyExtendedKeyUsage",
        "serverAuth",
        "clientAuth",
        "codeSigning",
        "emailProtection",
        "timeStamping",
        "OCSPSigning"
      ],
      "title": "KnownEKUs",
      "type": "string"
    },
    "Limbo": {
      "description": "The top-level testcase container.",
      "properties": {
        "version": {
          "const": 1,
          "description": "The limbo schema version; this must currently always be 1",
          "title": "Version"
        },
        "testcases": {
          "description": "One or more testcases in this testsuite",
          "items": {
            "$ref": "#/$defs/Testcase"
          },
          "title": "Testcases",
          "type": "array"
        }
      },
      "required": [
        "version",
        "testcases"
      ],
      "title": "Limbo",
      "type": "object"
    },
    "PeerName": {
      "description": "Represents a peer (i.e., end entity) certificate's name (Subject or SAN).",
      "properties": {
        "kind": {
          "anyOf": [
            {
              "const": "RFC822"
            },
            {
              "const": "DNS"
            },
            {
              "const": "IP"
            }
          ],
          "description": "The kind of peer name",
          "title": "Kind"
        },
        "value": {
          "description": "The peer's name",
          "title": "Value",
          "type": "string"
        }
      },
      "required": [
        "kind",
        "value"
      ],
      "title": "PeerName",
      "type": "object"
    },
    "SignatureAlgorithm": {
      "description": "Valid X.509 signature algorithms.",
      "enum": [
        "RSA_WITH_MD5",
        "RSA_WITH_SHA1",
        "RSA_WITH_SHA224",
        "RSA_WITH_SHA256",
        "RSA_WITH_SHA384",
        "RSA_WITH_SHA512",
        "RSA_WITH_SHA3_224",
        "RSA_WITH_SHA3_256",
        "RSA_WITH_SHA3_384",
        "RSA_WITH_SHA3_512",
        "RSASSA_PSS",
        "ECDSA_WITH_SHA1",
        "ECDSA_WITH_SHA224",
        "ECDSA_WITH_SHA256",
        "ECDSA_WITH_SHA384",
        "ECDSA_WITH_SHA512",
        "ECDSA_WITH_SHA3_224",
        "ECDSA_WITH_SHA3_256",
        "ECDSA_WITH_SHA3_384",
        "ECDSA_WITH_SHA3_512",
        "DSA_WITH_SHA1",
        "DSA_WITH_SHA224",
        "DSA_WITH_SHA256",
        "DSA_WITH_SHA384",
        "DSA_WITH_SHA512",
        "ED25519",
        "ED448",
        "GOSTR3411_94_WITH_3410_2001",
        "GOSTR3410_2012_WITH_3411_2012_256",
        "GOSTR3410_2012_WITH_3411_2012_512"
      ],
      "title": "SignatureAlgorithm",
      "type": "string"
    },
    "Testcase": {
      "description": "Represents an individual Limbo testcase.",
      "properties": {
        "id": {
          "description": "A short, unique identifier for this testcase",
          "pattern": "^([A-Za-z][A-Za-z0-9-.]+::)*([A-Za-z][A-Za-z0-9-.]+)$",
          "title": "Id",
          "type": "string"
        },
        "features": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/Feature"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "One or more human-readable tags that describe OPTIONAL functionality described by this testcase. Implementers should use this to specify testcases for non-mandatory X.509 behavior (like certificate policy validation) or for 'pedantic' cases. Consumers that don't understand a given feature should skip tests that are marked with it.",
          "title": "Features"
        },
        "description": {
          "description": "A short, Markdown-formatted description",
          "title": "Description",
          "type": "string"
        },
        "validation_kind": {
          "anyOf": [
            {
              "const": "CLIENT"
            },
            {
              "const": "SERVER"
            }
          ],
          "description": "The kind of validation to perform",
          "title": "Validation Kind"
        },
        "trusted_certs": {
          "description": "A list of PEM-encoded CA certificates to consider trusted",
          "items": {
            "type": "string"
          },
          "title": "Trusted Certs",
          "type": "array"
        },
        "untrusted_intermediates": {
          "description": "A list of PEM-encoded untrusted intermediates to use during path building",
          "items": {
            "type": "string"
          },
          "title": "Untrusted Intermediates",
          "type": "array"
        },
        "peer_certificate": {
          "description": "The PEM-encoded peer (EE) certificate",
          "title": "Peer Certificate",
          "type": "string"
        },
        "validation_time": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The time at which to perform the validation",
          "title": "Validation Time"
        },
        "signature_algorithms": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/SignatureAlgorithm"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A list of acceptable signature algorithms to constrain against",
          "title": "Signature Algorithms"
        },
        "key_usage": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/KeyUsage"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A constraining list of key usages",
          "title": "Key Usage"
        },
        "extended_key_usage": {
          "anyOf": [
            {
              "items": {
                "anyOf": [
                  {
                    "$ref": "#/$defs/KnownEKUs"
                  },
                  {
                    "pattern": "^([0-2])((\\.0)|(\\.[1-9][0-9]*))*$",
                    "type": "string"
                  }
                ]
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A constraining list of extended key usages, either in well-known form or as OIDs",
          "title": "Extended Key Usage"
        },
        "expected_result": {
          "anyOf": [
            {
              "const": "SUCCESS"
            },
            {
              "const": "FAILURE"
            }
          ],
          "description": "The expected validation result",
          "title": "Expected Result"
        },
        "expected_peer_name": {
          "anyOf": [
            {
              "$ref": "#/$defs/PeerName"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "For client-side validation: the expected peer name, if any"
        },
        "expected_peer_names": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/PeerName"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "For server-side validation: the expected peer names, if any",
          "title": "Expected Peer Names"
        }
      },
      "required": [
        "id",
        "description",
        "validation_kind",
        "trusted_certs",
        "untrusted_intermediates",
        "peer_certificate",
        "expected_result"
      ],
      "title": "Testcase",
      "type": "object"
    }
  },
  "title": "x509-limbo schemas"
}
